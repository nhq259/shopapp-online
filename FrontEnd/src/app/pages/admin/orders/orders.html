<div class="card shadow-sm">
  <div class="card-header d-flex justify-content-between align-items-center">
    <h5 class="mb-0">Quản lý đơn hàng</h5>

    <div class="d-flex gap-2">
      <input type="text" class="form-control" placeholder="Tìm theo ghi chú..." (ngModelChange)="onSearchChange($event)"
        [(ngModel)]="search" />

      <select class="form-select" [(ngModel)]="status" (ngModelChange)="onStatusChange($event)">
        <option value="">Tất cả trạng thái</option>
        <option *ngFor="let s of OrderStatus | keyvalue" [value]="s.value">
          {{ STATUS_LABEL[s.value] }}
        </option>
      </select>


    </div>
  </div>

  <div class="card-body">

    <div *ngIf="loading" class="text-center py-3">
      Đang tải dữ liệu...
    </div>

    <table class="table table-hover align-middle" *ngIf="!loading">
      <thead>
        <tr>
          <th>ID</th>
          <th>User ID</th>
          <th>Tổng tiền</th>
          <th>Status</th>
          <th>Created</th>
          <th width="150">Hành động</th>
        </tr>
      </thead>

      <tbody>
        <tr *ngFor="let o of orders">
          <td>#{{ o.id }}</td>
          <td>{{ o.user_id }}</td>
          <td class="fw-bold text-end">
            {{ o.total | number:'1.0-0' }} ₫
          </td>
          <td>
            <span class="order-status" [ngClass]="getStatusClass(o.status)">
              {{ getStatusLabel(o.status) }}
            </span>

          </td>

          <td>{{ o.createdAt | date:'short' }}</td>
          <td>
            <a class="btn btn-sm btn-info me-1" [routerLink]="['detail', o.id]">
              Chi tiết
            </a>
          </td>
        </tr>

        <tr *ngIf="orders.length === 0">
          <td colspan="6" class="text-center text-muted">
            Không có đơn hàng
          </td>
        </tr>
      </tbody>
    </table>

    <!-- PAGINATION -->
    <nav *ngIf="totalPages > 1" class="mt-3">
      <ul class="pagination justify-content-center mb-0">
        <li class="page-item" [class.disabled]="page === 1">
          <a class="page-link" (click)="changePage(page - 1)">«</a>
        </li>

        <li class="page-item" *ngFor="let p of [].constructor(totalPages); let i = index"
          [class.active]="page === i + 1">
          <a class="page-link" (click)="changePage(i + 1)">
            {{ i + 1 }}
          </a>
        </li>

        <li class="page-item" [class.disabled]="page === totalPages">
          <a class="page-link" (click)="changePage(page + 1)">»</a>
        </li>
      </ul>
    </nav>

  </div>
</div>